' Gambas class file


Public Sub Form_Open()
     
End

Public Sub Form_Close()
  FSimulation.Show
  FSimulation.Enabled = True
End

Public Sub Form_Activate()
  'Ergebnisdarstellung()   
End

Public Sub Ergebnisdarstellung()

Dim i As Integer
Dim Qabs, Qgeliefert, QPumpel As Float
Dim lsumme As Float

Dim fltPreisWS As Float
Dim intAnzahlWS As Integer


  lsumme = 0
  Qabs = 0
  Qgeliefert = 0
  QPumpel = 0
   

'------------berechne Netzlänge-----------------------
  For i = 0 To Global.conMaxRohre - 1
    lsumme += Global.fltRohrLaengeKosten[1, i]
  Next
    
'------------berechne Energiebedarfe-----------------------  
  For i = 0 To 8760 - 1
    QPumpel += CFloat(Global.strDatensatzSimErgebnis[21, i])
    Qabs += CFloat(Global.strDatensatzSimErgebnis[24, i])
    Qgeliefert += CFloat(Global.strDatensatzSimErgebnis[23, i])
  Next
  

  
'------------schreibe Ergebnis in Ausgabeblatt-----------------------

   txtlgesamt.Text = Format$(lsumme, "#,##0")
   txtQabsolut.text = Format$((Qabs / 1000), "#,##0")
   txtQgeliefert.text = Format$((Qgeliefert / 1000), "#,##0")
   txtQelPumpe.text = Format$((QPumpel / 1000), "#,##0")
   txtQgeliefertGL.text = Format$((Global.fltQGL / 1000), "#,##0")
   txtQgeliefertSPL.text = Format$((Global.fltQSPL / 1000), "#,##0")
   
   gdvRohrtrasse.Columns.count = 3
   gdvRohrtrasse.Columns[0].Title = "di [mm]"
   gdvRohrtrasse.Columns[0].Width = 100
   gdvRohrtrasse.Columns[1].Title = "Länge [trm]"
   gdvRohrtrasse.Columns[1].Width = 130
   gdvRohrtrasse.Columns[2].Title = "Kosten [€]"
   gdvRohrtrasse.Columns[2].Width = 200
   gdvRohrtrasse.Rows.count = Global.conMaxRohre
   
  
  For i = 0 To Global.conMaxRohre - 1
    gdvRohrtrasse[i, 0].text = Format$(Global.fltRohrLaengeKosten[0, i], "#,##0.0")
    gdvRohrtrasse[i, 1].text = Format$(Global.fltRohrLaengeKosten[1, i], "#,##0")
    gdvRohrtrasse[i, 2].text = Format$(Global.fltRohrLaengeKosten[2, i], "#,##0")
  Next
   
  txlKosten.text = Format$(Global.fltInvestNetz, "#,##0.")
  
  fltPreisWS = Global.fltInvestWS_SUMME
  txlPreisWS.text = Format$(fltPreisWS, "#,##0")
  intAnzahlWS = Global.fltInvestWS_SUMME / Global.fltInvestWS
  txlAnzahlWS.text = Format$(intAnzahlWS, "#,##0")
  txlPreisSPL.text = Format$(Global.fltInvestSPL, "#,##0")
  
  txlKostenspez.text = Format$((Global.fltAnnuitaet[0] / (Qgeliefert / 1000)), "#,##0")
  txlKostenspez2.text = Format$((Global.fltAnnuitaet[1] / (Qgeliefert / 1000)), "#,##0")
  txlKostenspez3.text = Format$((Global.fltAnnuitaet[2] / (Qgeliefert / 1000)), "#,##0")
  txlKostenspez4.text = Format$(((Global.fltAnnuitaet[0] + Global.fltAnnuitaet[1] + Global.fltAnnuitaet[2]) / (Qgeliefert / 1000)), "#,##0")
End



Public Sub btnExit_Click()
  FSimulation_Ausgabe.Close
  FSimulation.Enabled = True
  FSimulation.Show
End



Public Sub btnImportErgebnisse_Click()
  FSimulationsErgebnisDateiwahl.Show
  FSimulation_Ausgabe.close
  FSimulation.Enabled = False
End

Public Sub btnImportMIFMID_Click()
  FSimulationsErgebnisDateiwahlMIF.Show
  FSimulation_Ausgabe.close
  FSimulation.Enabled = False
End



Public Sub btnJDL_Click()
  Programmcode.Erzeuge_Jahresdauerlinie
End

Public Sub btnJDL2_Click()
   Programmcode.Erzeuge_Jahresdauerlinie_Zweileiter
End



Public Sub btnWirtschaftlichkeit_Click()
  FWirtschaftlichkeit.show
End
