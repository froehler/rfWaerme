' Gambas class file

Public Sub Form_Open()
  If Global.fltVorlauftemperatur > 19 Then
    txbTempVL.Text = CStr(Global.fltVorlauftemperatur)
    sliTempVL.Value = Global.fltVorlauftemperatur
  Endif
  
  If Global.fltGrenzVorlauftemperatur > 19 Then
    txbminTempVLHaus.Text = CStr(Global.fltGrenzVorlauftemperatur)
    sliminTempVLHaus.Value = Global.fltGrenzVorlauftemperatur
  Endif
  If Global.fltGrenzRuecklauftemperatur > 19 Then
    txbminTempHaus.Text = CStr(Global.fltGrenzRuecklauftemperatur)
    sliminTempHaus.Value = Global.fltGrenzRuecklauftemperatur
  Endif
  If Global.fltGrenzRuecklauftemperaturToleranz > 0 Then
    txbminTempHausToleranz.Text = CStr(Global.fltGrenzRuecklauftemperaturToleranz)
  Endif
  If Global.intSchritte > 0 Then
    txbSchritte.Text = CStr(Global.intSchritte)
  Endif
  If Global.intDaemmklasse > 0 Then
    Select Case Global.intDaemmklasse
      Case 1
        rdbDmKl1.value = True
      Case 2
        rdbDmKl2.value = True
      Case 3
        rdbDmKl3.value = True
    End Select
  Endif
  If Global.fltWaermetauscherdP > 0 Then
    txbWTdP.Text = CStr(Global.fltWaermetauscherdP)
  Endif
  If Global.fltZuschlagFormstuecke > 0 Then
    txbZfdP.Text = CStr(Global.fltZuschlagFormstuecke * 100)
    sliZfdP.Value = Global.fltZuschlagFormstuecke * 100
  Endif
  If Global.fltWirkungsgradPumpe > 0 Then
    txbEtaPumpe.Text = CStr(Global.fltWirkungsgradPumpe * 100)
    sliEtaPumpe.Value = Global.fltWirkungsgradPumpe * 100
  Endif
End

Public Sub Form_Close()
  FSimulation_Eingabe.Close
  FSimulation.Show
  FSimulation.Enabled = True
End


Public Sub btnOK_Click()
  Global.fltVorlauftemperatur = CFloat(txbTempVL.Text)
  Global.intDaemmklasse = CFloat(txbDmKl.Text)
  Global.fltZuschlagFormstuecke = CFloat(txbZfdP.Text) / 100
  Global.fltWaermetauscherdP = CFloat(txbWTdP.Text)
  Global.fltGrenzRuecklauftemperatur = CFloat(txbminTempHaus.Text)
  Global.fltGrenzVorlauftemperatur = CFloat(txbminTempVLHaus.Text)
  Global.fltGrenzRuecklauftemperaturToleranz = CFloat(txbminTempHausToleranz.Text)
  Global.intSchritte = CFloat(txbSchritte.Text)
  Global.fltWirkungsgradPumpe = CFloat(txbEtaPumpe.Text) / 100
  'Global.fltAnschlussgrad = 100
    
  FSimulation_Eingabe.Close
  FSimulation.Show
  FSimulation.Enabled = True
End


Public Sub btnExit_Click()
  FSimulation_Eingabe.Close
  FSimulation.Show
  FSimulation.Enabled = True
End



Public Sub sliTempVL_Change()
  txbTempVL.Text = sliTempVL.Value
End

Public Sub txbTempVL_LostFocus()
  Dim fltcatch As Float
  fltcatch = sliTempVL.Value
  sliTempVL.Value = CFloat(txbTempVL.Text)
  Catch
    sliTempVL.Value = fltcatch
    txbTempVL.Text = CStr(fltcatch)
End


Public Sub sliminTempVLHaus_Change()
  txbminTempVLHaus.Text = sliminTempVLHaus.Value
End

Public Sub txbminTempVLHaus_LostFocus()
  Dim fltcatch As Float
  fltcatch = sliminTempVLHaus.Value
  sliminTempVLHaus.Value = CFloat(txbminTempVLHaus.Text)
  Catch
    sliminTempVLHaus.Value = fltcatch
    txbminTempVLHaus.Text = CStr(fltcatch)
End


Public Sub sliminTempHaus_Change()
  txbminTempHaus.Text = sliminTempHaus.Value
End

Public Sub txbminTempHaus_LostFocus()
  Dim fltcatch As Float
  fltcatch = sliminTempHaus.Value
  sliminTempHaus.Value = CFloat(txbminTempHaus.Text)
  Catch
    sliminTempHaus.Value = fltcatch
    txbminTempHaus.Text = CStr(fltcatch)
End


Public Sub txbminTempHausToleranz_LostFocus()
  Dim fltcatch As Float
  fltcatch = CFloat(txbminTempHausToleranz.Text)
  If fltcatch < 0 Then txbminTempHausToleranz.Text = "1"
  Catch
    txbminTempHausToleranz.Text = "1"
End


Public Sub txbSchritte_LostFocus()
  Dim intcatch As Integer
  intcatch = Round(CFloat(txbSchritte.Text), 0)
  If intcatch < 1 Then txbSchritte.Text = "2"
  txbSchritte.Text = CStr(intcatch)
  Catch
    txbSchritte.Text = "2"
End


Public Sub rdbDmKl_Click()
  If rdbDmKl1.Value Then txbDmKl.text = "1"
  If rdbDmKl2.Value Then txbDmKl.text = "2"
  If rdbDmKl3.Value Then txbDmKl.text = "3"
End


Public Sub txbWTdP_LostFocus()
  Dim fltcatch As Integer
  fltcatch = CFloat(txbWTdP.Text)
  If fltcatch < 0 Then txbWTdP.Text = "0.5"
  'txbWTdP.Text = CStr(fltcatch)
  Catch
    txbWTdP.Text = "0.5"
End


Public Sub sliZfdP_Change()
  txbZfdP.Text = sliZfdP.Value
End

Public Sub txbZfdP_LostFocus()
  Dim fltcatch As Float
  fltcatch = sliZfdP.Value
  sliZfdP.Value = CFloat(txbZfdP.Text)
  Catch
    sliZfdP.Value = fltcatch
    txbZfdP.Text = CStr(fltcatch)
End


Public Sub sliEtaPumpe_Change()
  txbEtaPumpe.Text = sliEtaPumpe.Value
End

Public Sub txbEtaPumpe_LostFocus()
  Dim fltcatch As Float
  fltcatch = sliEtaPumpe.Value
  sliEtaPumpe.Value = CFloat(txbEtaPumpe.Text)
  Catch
    sliEtaPumpe.Value = fltcatch
    txbEtaPumpe.Text = CStr(fltcatch)
End



